<!--suppress JSAnnotator -->
<template>
    <div class="page " data-name="home"> <!-- page-with-subnavbar -->
        <!-- Top Navbar -->
        <div class="navbar">
            <div class="navbar-bg"></div>
            <div class="navbar-inner">
                <div class="left">
                    <a href="/panel-left/" class="link icon-only " >
                        <i class="icon material-icons">menu</i>
                    </a>
                </div>
                <div class="title sliding">
                    {{@global.LANGUAGE.HOME_MSG00}}
                </div>
                <div class="right">
                    <a href="#" class="link icon-only ">
                        <i class="f7-icons icon-other-barcode"></i>
                    </a>
                </div>
            </div>
        </div>
        <div class="toolbar tabbar toolbar-top">
            <div class="toolbar-inner">
                <!-- Links have "tab-link" class instead of just "link" to switch tabs -->
                <a href="#tab1" class="tab-link tab-link-active">IMSI</a>
                <a href="#tab2" class="tab-link">ICCID</a>
            </div>
        </div>

        <form class="searchbar custom-searchbar">
            <div class="searchbar-inner">
                <div class="searchbar-input-wrap">
                    <input type="search" placeholder="{{@global.LANGUAGE.COM_MSG002}}" title="{{@global.LANGUAGE.COM_MSG002}}">
                    <!--<i class="searchbar-icon"></i>-->
                    <span class="input-clear-button"></span>
                    <button type="submit" class="button "><i class="material-icons">search</i></button>
                </div>
                <!--<span class="searchbar-disable-button">{{@global.LANGUAGE.COM_MSG001}}</span>-->
            </div>
        </form>

        <div class="page-content">
            <!--fake tabs for tabbar correct working working-->
            <div class="tabs">
                <div class="tab-active" id="tab1"></div>
                <div id="tab2"></div>
            </div>

            <div class="searchbar-backdrop"></div>

            <div class="block searchbar-not-found">
                <div class="block-inner">{{@global.LANGUAGE.PROMPT_MSG000}}</div>
            </div>

            <div class="block searchbar-hide-on-search">
                <p>This block will be hidden on search. Lorem ipsum dolor sit amet, consectetur adipisicing elit.</p>
            </div>

            <div class="list virtual-list media-list no-hairlines no-chevron no-margin-top searchbar-found assetList">
                <!-- keep it empty -->
            </div>

        </div>


    </div>
</template>


<script>
    // script must return component object
    return {
        data: function () {
            let ret = {};

            return ret;
        },
        methods: {
            initSearchForm: function () {
                let self = this;
                let serchbarEl = self.$el.find('.searchbar');
                let listEl = self.$el.find('.assetList');
                self.Searchbar = self.$app.searchbar.create({
                    el: serchbarEl,
                    customSearch: true,
                });
                self.VirtualAssetList = app.virtualList.create({
                    el: listEl,
                    items : [],
                    //height: '',
                    renderItem: function (item, index) {

                        return `
                            <li>
                                <a href="#" class="item-link item-content">
                                    <div class="item-inner">
                                        <div class="item-title-row">
                                            <div class="item-title color-custom">
                                                <div class="display-flex">
                                                    <div class="prop-name">IMSI:</div>
                                                    <div >${ item.IMSI }</div>
                                                </div>
                                            </div>
                                            <div class="item-after color-custom"><i class="f7-icons icon-other-menu3"></i></div>
                                        </div>
                                        <div class="item-text">
                                            <div class="display-flex">
                                                <div class="prop-name">ICCID:</div>
                                                <div >${ item.ICCID }</div>
                                            </div>
                                            <div class="display-flex">
                                                <div class="prop-name">State:</div>
                                                <div >${ item.State }</div>
                                            </div>
                                            <div class="display-flex">
                                                <div class="prop-name">Rag:</div>
                                                <div >${ item.Rag }</div>
                                            </div>
                                        </div>
                                    </div>
                                </a>
                            </li>
                        `;
                    }
                });

                serchbarEl.on('submit', function () {
                    self.VirtualAssetList.replaceAllItems([
                        {
                            IMSI: 123123123123123,
                            ICCID: 3434343434,
                            State: 'Productive',
                            Rag: 1,
                        },
                        {
                            IMSI: 8798797634232345,
                            ICCID: 346657978098,
                            State: 'Active',
                            Rag: 2,
                        },
                        {
                            IMSI: 43534512312323534,
                            ICCID: 243234234,
                            State: 'Terminated',
                            Rag: 3,
                        }
                    ]);
                    console.log('submit');
                });
            }
        },

        on: {
            pageInit: function (e, page) {
                let self = this;

                self.initSearchForm();

            },
            pageAfterIn:function(){

            },
            pageAfterOut: function () {
                // page has left the view
            },

        }
    };
</script>